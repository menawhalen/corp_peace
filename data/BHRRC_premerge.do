* BHRRC pre-merge
import delimited "/Users/jblumenshine/Desktop/PEP Stata/BHRRC.csv", clear
save "/Users/jblumenshine/Desktop/PEP Stata/BHRRC.dta", replace

* Rename variables
rename v1 companies 
rename v2 company_sectors
rename v3 hqcountry
rename v4 countries
rename v5 regions
rename v6 response_sectors
rename v7 backdate
rename v8 title
rename v9 responded_to
rename v10 tags
rename v11 responded
rename v12 authors
rename v13 URL
rename v14 linktocompanypage

* Create Variable for year
gen date = date(backdate, "YMD")
format date %td
gen year = year(date)

* Generate ccode variable for mapping ISO Alpha-2 codes to COW country codes
gen ccode = .
		
		
		// separate out instances of multiple countries
		
		
* Mapping ISO Alpha-2 codes to COW codes and hqcountry names for all countries
replace ccode = 700 if countries == "AF", 
replace hqcountry = "Afghanistan" if hqcountry == "AF"
replace ccode = 339 if countries ==  "AL"
replace hqcountry = "Albania" if hqcountry ==  "AL"
replace ccode = 615 if countries == "DZ"
replace hqcountry = "Algeria" if hqcountry == "DZ"
replace ccode = 232 if countries == "AD"
replace hqcountry = "Andorra" if hqcountry == "AD"
replace ccode = 540 if countries ==  "AO"
replace hqcountry = "Angola" if hqcountry == "AO"
replace ccode = 58 if countries == "AG"
replace hqcountry = "Antigua and Barbuda" if hqcountry == "AG"
replace ccode = 160 if countries == "AR"
replace hqcountry= "Argentina" if hqcountry == "AR"
replace ccode = 371 if countries ==  "AM"
replace hqcountry = "Armenia" if hqcountry ==  "AM"
replace ccode = 900 if countries == "AU"
replace hqcountry = "Australia" if hqcountry == "AU"
replace ccode = 305 if countries == "AT"
replace hqcountry = "Austria" if hqcountry == "AT"
replace ccode = 373 if countries ==  "AZ"
replace hqcountry = "Azerbaijan" if hqcountry == "AZ"
replace ccode = 31 if countries == "BS"
replace hqcountry = "Bahamas" if hqcountry == "BS"
replace ccode = 692 if countries == "BH"
replace hqcountry = "Bahrain" if hqcountry == "BH"
replace ccode = 771 if countries ==  "BD"
replace hqcountry = "Bangladesh" if hqcountry == "BD"
replace ccode = 53 if countries == "BB"
replace hqcountry = "Barbados" if hqcountry == "BB"
replace ccode = 370 if countries == "BY"
replace hqcountry = "Belarus" if hqcountry == "BY"
replace ccode = 211 if countries ==  "BE"
replace hqcountry = "Belgium" if hqcountry == "BE"
replace ccode = 80 if countries == "BZ"
replace hqcountry = "Belize" if hqcountry == "BZ"
replace ccode = 434 if countries == "BJ"
replace hqcountry = "Benin" if hqcountry == "BJ"
replace ccode = 760 if countries ==  "BT"
replace hqcountry = "Bhutan" if hqcountry == "BT"
replace ccode = 145 if countries == "BO"
replace hqcountry = "Bolivia" if hqcountry == "BO"
replace ccode = 346 if countries == "BA"
replace hqcountry = "Bosnia and Herzegovina" if hqcountry == "BA"
replace ccode = 571 if countries ==  "BW"
replace hqcountry = "Botswana" if hqcountry == "BW"
replace ccode = 140 if countries == "BR"
replace hqcountry = "Brazil" if hqcountry == "BR"
replace ccode = 835 if countries == "BN"
replace hqcountry = "Brunei" if hqcountry == "BN"
replace ccode = 355 if countries ==  "BG"
replace hqcountry = "Bulgaria" if hqcountry == "BG"
replace ccode = 439 if countries == "BF"
replace hqcountry = "Burkina Faso" if hqcountry == "BF"
replace ccode = 516 if countries == "BI"
replace hqcountry = "Burundi" if hqcountry == "BI"
replace ccode = 811 if countries ==  "KH"
replace hqcountry = "Cambodia" if hqcountry == "KH"
replace ccode = 471 if countries == "CM"
replace hqcountry = "Cameroon" if hqcountry == "CM"
replace ccode = 20 if countries == "CA"
replace hqcountry = "Canada" if hqcountry == "CA"
replace ccode = 402 if countries ==  "CV"
replace hqcountry = "Cape Verde" if hqcountry == "CV"
replace ccode = 482 if countries == "CF"
replace hqcountry = "Central African Republic" if hqcountry == "CF"
replace ccode = 483 if countries == "TD"
replace hqcountry = "Chad" if hqcountry == "TD"
replace ccode = 155 if countries == "CL"
replace hqcountry = "Chile" if hqcountry == "CL"
replace ccode = 710 if countries ==  "CN"
replace hqcountry = "China" if hqcountry == "CN"
replace ccode = 100 if countries == "CO"
replace hqcountry = "Colombia" if hqcountry == "CO"
replace ccode = 581 if countries == "KM"
replace hqcountry = "Comoros" if hqcountry == "KM"
replace ccode = 484 if countries == "CG"
replace hqcountry = "Congo" if hqcountry == "CG"
replace ccode = 94 if countries ==  "CR"
replace hqcountry = "Costa Rica" if hqcountry == "CR"
replace ccode = 437 if countries == "CI"
replace hqcountry = "Ivory Coast" if hqcountry == "CI"
replace ccode = 344 if countries ==  "HR"
replace hqcountry = "Croatia" if hqcountry == "HR"
replace ccode = 40 if countries == "CU"
replace hqcountry = "Cuba" if hqcountry == "CU"
replace ccode = 352 if countries == "CY"
replace hqcountry = "Cyprus" if hqcountry == "CY"
replace ccode = 315 if countries == "CS"
replace hqcountry = "Czechoslovakia" if hqcountry == "CS"
replace ccode = 316 if countries == "CZ"
replace hqcountry = "Czech Republic" if hqcountry == "CZ"
replace ccode = 490 if countries == "CD"
replace hqcountry = "Democratic Republic of the Congo" if hqcountry == "CD"
replace ccode = 390 if countries == "DK"
replace hqcountry = "Denmark" if hqcountry == "DK"
replace ccode = 522 if countries ==  "DJ"
replace hqcountry = "Djibouti" if hqcountry == "DJ"
replace ccode = 42 if countries == "DO"
replace hqcountry = "Dominican Republic" if hqcountry == "DO"
replace ccode = 130 if countries == "EC"
replace hqcountry = "Ecuador" if hqcountry == "EC"
replace ccode = 651 if countries == "EG"
replace hqcountry = "Egypt" if hqcountry == "EG"
replace ccode = 92 if countries ==  "SV"
replace hqcountry = "El Salvador" if hqcountry == "SV"
replace ccode = 411 if countries == "GQ"
replace hqcountry = "Equatorial Guinea" if hqcountry == "GQ"
replace ccode = 531 if countries == "ER"
replace hqcountry = "Eritrea" if hqcountry == "ER"
replace ccode = 366 if countries == "EE"
replace hqcountry = "Estonia" if hqcountry == "EE"
replace ccode = 530 if countries == "ET"
replace hqcountry = "Ethiopia" if hqcountry == "ET"
replace ccode = 950 if countries ==  "FJ"
replace hqcountry = "Fiji" if hqcountry == "FJ"
replace ccode = 375 if countries == "FI"
replace hqcountry = "Finland" if hqcountry == "FI"
replace ccode = 220 if countries == "FR"
replace hqcountry = "France" if hqcountry == "FR"
replace ccode = 481 if countries == "GA"
replace hqcountry = "Gabon" if hqcountry == "GA"
replace ccode = 420 if countries == "GM"
replace hqcountry = "Gambia" if hqcountry == "GM"
replace ccode = 372 if countries ==  "GE"
replace hqcountry = "Georgia" if hqcountry == "GE"
replace ccode = 255 if countries == "DE"
replace hqcountry = "Germany" if hqcountry == "DE"
replace ccode = 452 if countries == "GH"
replace hqcountry = "Ghana" if hqcountry == "GH"
replace ccode = 350 if countries == "GR"
replace hqcountry = "Greece" if hqcountry == "GR"
replace ccode = 55 if countries ==  "GD"
replace hqcountry = "Grenada" if hqcountry == "GD"
replace ccode = 90 if countries == "GT"
replace hqcountry = "Guatemala" if hqcountry == "GT"
replace ccode = 438 if countries == "GN"
replace hqcountry = "Guinea" if hqcountry == "GN"
replace ccode = 404 if countries == "GW"
replace hqcountry = "Guinea-Bissau" if hqcountry == "GW"
replace ccode = 110 if countries ==  "GY"
replace hqcountry = "Guyana" if hqcountry == "GY"
replace ccode = 41 if countries == "HT"
replace hqcountry = "Haiti" if hqcountry == "HT"
replace ccode = 91 if countries == "HN"
replace hqcountry = "Honduras" if hqcountry == "HN"
replace ccode = 310 if countries == "HU"
replace hqcountry = "Hungary" if hqcountry == "HU"
replace ccode = 395 if countries ==  "IS"
replace hqcountry = "Iceland" if hqcountry == "IS"
replace ccode = 750 if countries == "IN"
replace hqcountry = "India" if hqcountry == "IN"
replace ccode = 850 if countries == "ID"
replace hqcountry = "Indonesia" if hqcountry == "ID"
replace ccode = 630 if countries == "IR"
replace hqcountry = "Iran" if hqcountry == "IR"
replace ccode = 645 if countries ==  "IQ"
replace hqcountry = "Iraq" if hqcountry == "IQ"
replace ccode = 205 if countries == "IE"
replace hqcountry = "Ireland" if hqcountry == "IE"
replace ccode = 666 if countries == "IL"
replace hqcountry = "Israel" if hqcountry == "IL"
replace ccode = 325 if countries == "IT"
replace hqcountry = "Italy" if hqcountry == "IT"
replace ccode = 51 if countries ==  "JM"
replace hqcountry = "Jamaica" if hqcountry == "JM"
replace ccode = 740 if countries == "JP"
replace hqcountry = "Japan" if hqcountry == "JP"
replace ccode = 663 if countries == "JO"
replace hqcountry = "Jordan" if hqcountry == "JO"
replace ccode = 705 if countries == "KZ"
replace hqcountry = "Kazakhstan" if hqcountry == "KZ"
replace ccode = 501 if countries ==  "KE"
replace hqcountry = "Kenya" if hqcountry == "KE"
replace ccode = 731 if countries == "KP"
replace hqcountry = "North Korea" if hqcountry == "KP"
replace ccode = 732 if countries ==  "KR"
replace hqcountry = "South Korea" if hqcountry == "KR"
replace ccode = 690 if countries == "KW"
replace hqcountry = "Kuwait" if hqcountry == "KW"
replace ccode = 703 if countries == "KG"
replace hqcountry = "Kyrgyzstan" if hqcountry == "KG"
replace ccode = 812 if countries == "LA"
replace hqcountry = "Laos" if hqcountry == "LA"
replace ccode = 367 if countries == "LV"
replace hqcountry = "Latvia" if hqcountry == "LV"
replace ccode = 660 if countries == "LB"
replace hqcountry = "Lebanon" if hqcountry == "LB"
replace ccode = 570 if countries ==  "LS"
replace hqcountry = "Lesotho" if hqcountry == "LS"
replace ccode = 450 if countries == "LR"
replace hqcountry = "Liberia" if hqcountry == "LR"
replace ccode = 620 if countries == "LY"
replace hqcountry = "Libya" if hqcountry == "LY"
replace ccode = 368 if countries == "LT"
replace hqcountry = "Lithuania" if hqcountry == "LT"
replace ccode = 212 if countries ==  "LU"
replace hqcountry = "Luxembourg" if hqcountry == "LU"
replace ccode = 580 if countries == "MG"
replace hqcountry = "Madagascar" if hqcountry == "MG"
replace ccode = 553 if countries ==  "MW"
replace hqcountry = "Malawi" if hqcountry == "MW"
replace ccode = 820 if countries == "MY"
replace hqcountry = "Malaysia" if hqcountry == "MY"
replace ccode = 781 if countries == "MV"
replace hqcountry = "Maldives" if hqcountry == "MV"
replace ccode = 432 if countries == "ML"
replace hqcountry = "Mali" if hqcountry == "ML"
replace ccode = 338 if countries ==  "MT"
replace hqcountry = "Malta" if hqcountry == "MT"
replace ccode = 70 if countries == "MX"
replace hqcountry = "Mexico" if hqcountry == "MX"
replace ccode = 359 if countries ==  "MD"
replace hqcountry = "Moldova" if hqcountry == "MD"
replace ccode = 221 if countries == "MC"
replace hqcountry = "Monaco" if hqcountry == "MC"
replace ccode = 712 if countries == "MN"
replace hqcountry = "Mongolia" if hqcountry == "MN"
replace ccode = 341 if countries == "ME"
replace hqcountry = "Montenegro" if hqcountry == "ME"
replace ccode = 600 if countries ==  "MA"
replace hqcountry = "Morocco" if hqcountry == "MA"
replace ccode = 541 if countries == "MZ"
replace hqcountry = "Mozambique" if hqcountry == "MZ"
replace ccode = 775 if countries ==  "MM"
replace hqcountry = "Myanmar" if hqcountry == "MM"
replace ccode = 565 if countries == "NA"
replace hqcountry = "Namibia" if hqcountry == "NA"
replace ccode = 790 if countries == "NP"
replace hqcountry = "Nepal" if hqcountry == "NP"
replace ccode = 210 if countries == "NL"
replace hqcountry = "Netherlands" if hqcountry == "NL"
replace ccode = 920 if countries ==  "NZ"
replace hqcountry = "New Zealand" if hqcountry == "NZ"
replace ccode = 93 if countries == "NI"
replace hqcountry = "Nicaragua" if hqcountry == "NI"
replace ccode = 436 if countries ==  "NE"
replace hqcountry = "Niger" if hqcountry == "NE"
replace ccode = 475 if countries == "NG"
replace hqcountry = "Nigeria" if hqcountry == "NG"
replace ccode = 385 if countries == "NO"
replace hqcountry = "Norway" if hqcountry == "NO"
replace ccode = 698 if countries == "OM"
replace hqcountry = "Oman" if hqcountry == "OM"
replace ccode = 770 if countries ==  "PK"
replace hqcountry = "Pakistan" if hqcountry == "PK"
replace ccode = 95 if countries == "PA"
replace hqcountry = "Panama" if hqcountry == "PA"
replace ccode = 910 if countries ==  "PG"
replace hqcountry = "Papua New Guinea" if hqcountry == "PG"
replace ccode = 150 if countries == "PY"
replace hqcountry = "Paraguay" if hqcountry == "PY"
replace ccode = 135 if countries == "PE"
replace hqcountry = "Peru" if hqcountry == "PE"
replace ccode = 840 if countries == "PH"
replace hqcountry = "Philippines" if hqcountry == "PH"
replace ccode = 290 if countries ==  "PL"
replace hqcountry = "Poland" if hqcountry == "PL"
replace ccode = 235 if countries == "PT"
replace hqcountry = "Portugal" if hqcountry == "PT"
replace ccode = 694 if countries ==  "QA"
replace hqcountry = "Qatar" if hqcountry == "QA"
replace ccode = 360 if countries == "RO"
replace hqcountry = "Romania" if hqcountry == "RO"
replace ccode = 365 if countries == "RU"
replace hqcountry = "Russia" if hqcountry == "RU"
replace ccode = 670 if countries == "SA"
replace hqcountry = "Saudi Arabia" if hqcountry == "SA"
replace ccode = 433 if countries ==  "SN"
replace hqcountry = "Senegal" if hqcountry == "SN"
replace ccode = 941 if countries == "RS"
replace hqcountry = "Serbia" if hqcountry == "RS"
replace ccode = 830 if countries ==  "SG"
replace hqcountry = "Singapore" if hqcountry == "SG"
replace ccode = 560 if countries == "ZA"
replace hqcountry = "South Africa" if hqcountry == "ZA"
replace ccode = 230 if countries == "ES"
replace hqcountry = "Spain" if hqcountry == "ES"
replace ccode = 780 if countries == "LK"
replace hqcountry = "Sri Lanka" if hqcountry == "LK"
replace ccode = 625 if countries ==  "SD"
replace hqcountry = "Sudan" if hqcountry == "SD"
replace ccode = 380 if countries == "SE"
replace hqcountry = "Sweden" if hqcountry == "SE"
replace ccode = 225 if countries ==  "CH"
replace hqcountry = "Switzerland" if hqcountry == "CH"
replace ccode = 652 if countries == "SY"
replace hqcountry = "Syria" if hqcountry == "SY"
replace ccode = 510 if countries == "TZ"
replace hqcountry = "Tanzania" if hqcountry == "TZ"
replace ccode = 800 if countries == "TH"
replace hqcountry = "Thailand" if hqcountry == "TH"
replace ccode = 461 if countries ==  "TG"
replace hqcountry = "Togo" if hqcountry == "TG"
replace ccode = 616 if countries == "TN"
replace hqcountry = "Tunisia" if hqcountry == "TN"
replace ccode = 640 if countries ==  "TR"
replace hqcountry = "Turkey" if hqcountry == "TR"
replace ccode = 52 if countries == "TT"
replace hqcountry = "Trinidad and Tobago" if hqcountry == "TT"
replace ccode = 369 if countries == "UA"
replace hqcountry = "Ukraine" if hqcountry == "UA"
replace ccode = 696 if countries == "AE"
replace hqcountry = "United Arab Emirates" if hqcountry == "AE"
replace ccode = 200 if countries == "GB"
replace hqcountry = "United Kingdom" if hqcountry == "GB"
replace ccode = 2 if countries ==  "US"
replace hqcountry = "United States" if hqcountry == "US"
replace ccode = 165 if countries == "UY"
replace hqcountry = "Uruguay" if hqcountry == "UY"
replace ccode = 101 if countries ==  "VE"
replace hqcountry = "Venezuela" if hqcountry == "VE"
replace ccode = 816 if countries == "VN"
replace hqcountry = "Vietnam" if hqcountry == "VN"
replace ccode = 679 if countries == "YE"
replace hqcountry = "Yemen" if hqcountry == "YE"
replace ccode = 551 if countries == "ZM"
replace hqcountry = "Zambia" if hqcountry == "ZM"
replace ccode = 552 if countries ==  "ZW"
replace hqcountry = "Zimbabwe" if hqcountry == "ZW"
replace ccode = 347 if countries == "XK"
replace hqcountry = "Kosovo" if hqcountry == "XK"
replace ccode = 56 if countries == "LC"
replace hqcountry = "St. Lucia" if hqcountry == "LC"
replace ccode = 57 if countries == "VC"
replace hqcountry = "St. Vincent and the Grenadines" if hqcountry == "VC"
replace ccode = 60 if countries == "KN"
replace hqcountry = "St. Kitts and Nevis" if hqcountry == "KN"
replace ccode = 115 if countries == "SR"
replace hqcountry = "Suriname" if hqcountry == "SR"
replace ccode = 223 if countries == "LI"
replace hqcountry = "Liechtenstein" if hqcountry == "LI"
replace ccode = 317 if countries == "SK"
replace hqcountry = "Slovakia" if hqcountry == "SK"
replace ccode = 331 if countries == "SM"
replace hqcountry = "San Marino" if hqcountry == "SM"
replace ccode = 349 if countries == "SI"
replace hqcountry = "Slovenia" if hqcountry == "SI"
replace ccode = 404 if countries == "ST"
replace hqcountry = "Sao Tome and Principe" if hqcountry == "ST"
replace ccode = 435 if countries == "MR"
replace hqcountry = "Mauritania" if hqcountry == "MR"
replace ccode = 451 if countries == "SL"
replace hqcountry = "Sierra Leone" if hqcountry == "SL"
replace ccode = 500 if countries == "UG"
replace hqcountry = "Uganda" if hqcountry == "UG"
replace ccode = 517 if countries == "RW"
replace hqcountry = "Rwanda" if hqcountry == "RW"
replace ccode = 520 if countries == "SO"
replace hqcountry = "Somalia" if hqcountry == "SO"
replace ccode = 565 if countries == "NA"
replace hqcountry = "Namibia" if hqcountry == "NA"
replace ccode = 572 if countries == "SZ"
replace hqcountry = "Eswatini" if hqcountry == "SZ"
replace ccode = 590 if countries == "MU"
replace hqcountry = "Mauritius" if hqcountry == "MU"
replace ccode = 591 if countries == "SC"
replace hqcountry = "Seychelles" if hqcountry == "SC"
replace ccode = 626 if countries == "SS"
replace hqcountry = "South Sudan" if hqcountry == "SS"
replace ccode = 701 if countries == "TM"
replace hqcountry = "Turkmenistan" if hqcountry == "TM"
replace ccode = 702 if countries == "TJ"
replace hqcountry = "Tajikistan" if hqcountry == "TJ"
replace ccode = 704 if countries == "UZ"
replace hqcountry = "Uzbekistan" if hqcountry == "UZ"
replace ccode = 713 if countries == "TW"
replace hqcountry = "Taiwan" if hqcountry == "TW"
replace ccode = 860 if countries == "TL"
replace hqcountry = "Timor-Leste" if hqcountry == "TL"
replace ccode = 935 if countries == "VU"
replace hqcountry = "Vanuatu" if hqcountry == "VU"
replace ccode = 940 if countries == "SB"
replace hqcountry = "Solomon Islands" if hqcountry == "SB"
replace ccode = 946 if countries == "KI"
replace hqcountry = "Kiribati" if hqcountry == "KI"
replace ccode = 947 if countries == "TV"
replace hqcountry = "Tuvalu" if hqcountry == "TV"
replace ccode = 955 if countries == "TO"
replace hqcountry = "Tonga" if hqcountry == "TO"
replace ccode = 970 if countries == "NR"
replace hqcountry = "Nauru" if hqcountry == "NR"
replace ccode = 983 if countries == "MH"
replace hqcountry = "Marshall Islands" if hqcountry == "MH"
replace ccode = 986 if countries == "PW"
replace hqcountry = "Palau" if hqcountry == "PW"
replace ccode = 987 if countries == "FM"
replace hqcountry = "Federated States of Micronesia" if hqcountry == "FM"
replace ccode = 990 if countries == "WS"
replace hqcountry = "Samoa" if hqcountry == "WS"

* Label variables
label variable countries "using ISO alpha-2 code"
label variable ccode "COW code"


// Convert wide data (country-level) to long data (company-country-year level)

